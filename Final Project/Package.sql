SET search_path TO PackageTracking;

--DROP TABLE IF EXISTS Package;
--TRUNCATE TABLE Package;


CREATE TABLE Package (
    id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    weight DECIMAL(10,2),
    status VARCHAR (50),
    created_time TIMESTAMP,
    hub_id INT,
    FOREIGN KEY (hub_id) REFERENCES Hub(id)
);

--DELETE FROM Package;

INSERT INTO Package (weight, status, created_time, hub_id) VALUES
(4.82, 'Created', '2025-01-05 09:14:00', 7),
(12.55, 'In Transit', '2025-01-05 14:22:00', 19),
(7.40, 'At Hub', '2025-01-06 11:03:00', 3),
(28.10, 'Out for Delivery', '2025-01-06 16:33:00', 12),
(3.22, 'Delivered', '2025-01-07 10:12:00', 5),
(17.90, 'Created', '2025-01-07 13:40:00', 25),
(9.33, 'In Transit', '2025-01-08 08:55:00', 14),
(22.60, 'At Hub', '2025-01-08 12:44:00', 21),
(5.77, 'Out for Delivery', '2025-01-08 17:02:00', 8),
(49.25, 'Delivered', '2025-01-09 09:10:00', 17),
(11.10, 'Created', '2025-01-09 15:55:00', 4),
(6.48, 'In Transit', '2025-01-10 10:23:00', 20),
(41.33, 'At Hub', '2025-01-10 13:47:00', 9),
(16.20, 'Out for Delivery', '2025-01-11 08:11:00', 6),
(2.80, 'Delivered', '2025-01-11 18:21:00', 2),
(3.90, 'Created', '2025-01-12 11:50:00', 11),
(8.25, 'In Transit', '2025-01-12 14:32:00', 10),
(27.19, 'At Hub', '2025-01-13 07:59:00', 23),
(18.00, 'Out for Delivery', '2025-01-13 12:28:00', 1),
(9.76, 'Delivered', '2025-01-14 15:30:00', 15),
(14.82, 'Created', '2025-01-14 17:48:00', 13),
(36.55, 'In Transit', '2025-01-15 08:14:00', 22),
(4.99, 'At Hub', '2025-01-15 11:50:00', 24),
(30.10, 'Out for Delivery', '2025-01-16 09:05:00', 16),
(12.14, 'Delivered', '2025-01-16 16:55:00', 18),
(33.22, 'Created', '2025-01-17 10:23:00', 7),
(10.40, 'In Transit', '2025-01-17 13:55:00', 5),
(25.60, 'At Hub', '2025-01-17 18:14:00', 2),
(3.55, 'Out for Delivery', '2025-01-18 11:32:00', 9),
(47.88, 'Delivered', '2025-01-18 15:42:00', 25),
(8.67, 'Created', '2025-01-19 08:45:00', 20),
(15.42, 'In Transit', '2025-01-19 13:10:00', 3),
(6.58, 'At Hub', '2025-01-19 16:52:00', 11),
(23.90, 'Out for Delivery', '2025-01-20 10:22:00', 17),
(2.45, 'Delivered', '2025-01-20 14:10:00', 24),
(12.33, 'Created', '2025-01-21 09:18:00', 19),
(19.74, 'In Transit', '2025-01-21 13:43:00', 6),
(4.27, 'At Hub', '2025-01-21 18:25:00', 8),
(30.62, 'Out for Delivery', '2025-01-22 09:31:00', 10),
(7.40, 'Delivered', '2025-01-22 15:02:00', 2),
(16.88, 'Created', '2025-01-23 10:44:00', 5),
(22.31, 'In Transit', '2025-01-23 13:58:00', 1),
(9.12, 'At Hub', '2025-01-23 17:29:00', 21),
(11.55, 'Out for Delivery', '2025-01-24 08:55:00', 7),
(43.70, 'Delivered', '2025-01-24 14:17:00', 14),
(5.69, 'Created', '2025-01-25 11:15:00', 12),
(34.81, 'In Transit', '2025-01-25 16:30:00', 25),
(3.25, 'At Hub', '2025-01-26 07:42:00', 4),
(21.60, 'Out for Delivery', '2025-01-26 12:50:00', 16),
(17.44, 'Delivered', '2025-01-27 15:03:00', 9),
(10.03, 'Created', '2025-01-27 18:30:00', 23),
(28.92, 'In Transit', '2025-01-28 09:10:00', 18),
(3.84, 'At Hub', '2025-01-28 13:40:00', 20),
(14.10, 'Out for Delivery', '2025-01-28 17:15:00', 13),
(24.77, 'Delivered', '2025-01-29 10:22:00', 15),
(8.51, 'Created', '2025-01-29 13:55:00', 22),
(39.63, 'In Transit', '2025-01-30 08:34:00', 5),
(2.95, 'At Hub', '2025-01-30 12:58:00', 8),
(33.44, 'Out for Delivery', '2025-01-31 09:40:00', 2),
(11.90, 'Delivered', '2025-01-31 14:28:00', 19),
(45.13, 'Created', '2025-02-01 10:00:00', 25),
(7.74, 'In Transit', '2025-02-01 15:12:00', 9),
(18.66, 'At Hub', '2025-02-02 08:47:00', 17),
(6.02, 'Out for Delivery', '2025-02-02 11:53:00', 3),
(29.81, 'Delivered', '2025-02-02 18:14:00', 11),
(20.07, 'Created', '2025-02-03 09:23:00', 1),
(25.66, 'In Transit', '2025-02-03 14:05:00', 7),
(5.13, 'At Hub', '2025-02-04 10:15:00', 4),
(41.90, 'Out for Delivery', '2025-02-04 13:57:00', 21),
(15.55, 'Delivered', '2025-02-04 17:20:00', 6),
(19.40, 'Created', '2025-02-05 09:30:00', 20),
(3.99, 'In Transit', '2025-02-05 13:44:00', 12),
(12.77, 'At Hub', '2025-02-06 08:11:00', 23),
(28.21, 'Out for Delivery', '2025-02-06 11:40:00', 14),
(37.48, 'Delivered', '2025-02-06 16:28:00', 10),
(4.52, 'Created', '2025-02-07 10:45:00', 24),
(14.18, 'In Transit', '2025-02-07 13:57:00', 8),
(8.61, 'At Hub', '2025-02-08 07:59:00', 2),
(31.90, 'Out for Delivery', '2025-02-08 12:25:00', 16),
(9.08, 'Delivered', '2025-02-08 15:47:00', 18);


SELECT * FROM Package;


SELECT * FROM Package
WHERE created_time BETWEEN '2025-01-07 00:00:00' AND '2025-01-08 23:59:59';

SELECT
    status,
    COUNT(*) as total_packages
FROM Package
GROUP BY status
ORDER BY total_packages DESC;